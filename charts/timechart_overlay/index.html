<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>____ Timechart Overlalys - Juttle Visualization Library</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../custom_theme/extra.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "____ Timechart Overlalys";
    var mkdocs_page_input_path = "charts/timechart_overlay.md";
    var mkdocs_page_url = "/charts/timechart_overlay/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Juttle Visualization Library</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
  
    <li class="toctree-l1 ">
        <a class="" href="../..">About</a>
<!-- Removed the subsection list that duplicates subsection title in most cases -->
    </li>
  
<li>
          
            <li>
  
    <li class="toctree-l1 ">
        <a class="" href="../barchart/">barchart</a>
<!-- Removed the subsection list that duplicates subsection title in most cases -->
    </li>
  
<li>
          
            <li>
  
    <li class="toctree-l1 ">
        <a class="" href="../events/">events</a>
<!-- Removed the subsection list that duplicates subsection title in most cases -->
    </li>
  
<li>
          
            <li>
  
    <li class="toctree-l1 ">
        <a class="" href="../file/">file</a>
<!-- Removed the subsection list that duplicates subsection title in most cases -->
    </li>
  
<li>
          
            <li>
  
    <li class="toctree-l1 ">
        <a class="" href="../less/">less</a>
<!-- Removed the subsection list that duplicates subsection title in most cases -->
    </li>
  
<li>
          
            <li>
  
    <li class="toctree-l1 ">
        <a class="" href="../text/">text</a>
<!-- Removed the subsection list that duplicates subsection title in most cases -->
    </li>
  
<li>
          
            <li>
  
    <li class="toctree-l1 ">
        <a class="" href="../piechart/">piechart</a>
<!-- Removed the subsection list that duplicates subsection title in most cases -->
    </li>
  
<li>
          
            <li>
  
    <li class="toctree-l1 ">
        <a class="" href="../scatterchart/">scatterchart</a>
<!-- Removed the subsection list that duplicates subsection title in most cases -->
    </li>
  
<li>
          
            <li>
  
    <li class="toctree-l1 ">
        <a class="" href="../table/">table</a>
<!-- Removed the subsection list that duplicates subsection title in most cases -->
    </li>
  
<li>
          
            <li>
  
    <li class="toctree-l1 ">
        <a class="" href="../tile/">tile</a>
<!-- Removed the subsection list that duplicates subsection title in most cases -->
    </li>
  
<li>
          
            <li>
  
    <li class="toctree-l1 ">
        <a class="" href="../timechart/">timechart</a>
<!-- Removed the subsection list that duplicates subsection title in most cases -->
    </li>
  
<li>
          
            <li>
  
<li>
          
            <li>
  
<li>
          
            <li>
  
<li>
          
            <li>
  
<li>
          
            <li>
  
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Juttle Visualization Library</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
    
    <li>____ Timechart Overlalys</li>
    <li class="wy-breadcrumbs-aside">
      
        
          
            <a href="https://github.com/juttle/juttle-viz/blob/master/docs/charts/timechart_overlay.md" class="icon icon-github"> Edit on GitHub</a>
          
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <div class="toc">
<ul>
<li><a href="#overlaying-events-on-time-charts">Overlaying events on time charts</a></li>
<li><a href="#comparing-data-from-different-intervals">Comparing data from different intervals</a></li>
</ul>
</div>
<h1 id="overlaying-events-on-time-charts">Overlaying events on time charts</h1>
<p>The <a href="../events/">events</a>
output can be overlaid on a
<a href="../timechart/">timechart</a>
to produce a single visual output. You can imagine the resulting
visualization as having two layers.</p>
<p>Chart overlays must observe the following rules:</p>
<ul>
<li>Only charts with the same X axis may be overlaid.</li>
<li>The top or overlaid chart will create a second Y axis on right hand
    side of chart.</li>
<li>
<p>Only the title of the bottom chart will display; the title parameter
    of the top chart will be ignored.</p>
</li>
<li>
<p>Create two flows: one that ends with
    view <a href="../events/">events</a>
    and one that ends with
    view <a href="../timechart/">timechart</a>.</p>
</li>
<li>
<p>Give an <code>-id</code> parameter to your view timechart, with any arbitrary string as
    its value.</p>
<p>All <a href="../..">visual outputs</a>
accept an <code>-id</code> parameter, but currently only view timechart supports overlays.</p>
</li>
<li>
<p>Give an <code>-on</code> parameter to the events view, with the value of your time chart's ID.</p>
</li>
</ul>
<p><em>Example: Overlay two series of "git merge" events on a timechart showing CPU load</em></p>
<pre><code>const spiketime1 = :7 minutes before 2014-01-01:;
const spiketime2 = :3 minutes before 2014-01-01:;

reducer spike_cpu(valfield,hostname,time) {

    // workaround for PROD-5118, once its fixed we can remove this const redefinition
    const spiketime1 = :7 minutes before 2014-01-01:;
    const spiketime2 = :3 minutes before 2014-01-01:;

    var spike1 = 0;
    var spike2 = 0;
    var val = 0;

    function update() {
        if (*time &gt; spiketime1) {
        spike1 = 1;
        }
        if (*time &gt; spiketime2) {
        spike2 = 1;
        }
        if ((*hostname == &quot;nyc.2&quot;) &amp;&amp; spike1 != 0) {
        val = *valfield + 0.5;
        } else {
        if ((*hostname == &quot;sea.0&quot;) &amp;&amp; spike2 != 0) {
            val = *valfield + 0.2;
        } else {
            val = *valfield;
        }
        }
    }

    function result() {
        return val;
    }

}

read stochastic -source 'cdn' -nhosts 3 -from :10 minutes before 2014-01-01: -to :2014-01-01: -source_type 'metrics' name = 'cpu'
|filter name = 'cpu'
|put value=spike_cpu(value,host,time)
|  view timechart
     -valueField 'value'
     -keyField 'host'
     -yScales.primary.tickFormat '%'
     -title &quot;% CPU busy on all hosts&quot;
     -id 'CPU';

emit -limit 1 -from spiketime1
| put title = &quot;title&quot;,type = &quot;git&quot;,text = &quot;Enable new CPU-consuming service in New York&quot;,label = &quot;git merge&quot;
| view events
    -on &quot;CPU&quot;
    -typeField &quot;type&quot;
    -timeField &quot;time&quot;
    -messageField &quot;text&quot;
    -nameField &quot;label&quot;;

emit -limit 1 -from spiketime2
| put title = &quot;title&quot;,type = &quot;git&quot;,text = &quot;Something that thrashes the CPU in Seattle&quot;,label = &quot;git merge&quot;
| view events
    -on &quot;CPU&quot; -typeField &quot;type&quot;
    -timeField &quot;time&quot;
    -messageField &quot;text&quot;
    -nameField &quot;label&quot;;
</code></pre>

<p><img alt="" src="../../images/screenshots/view_events.png" /></p>
<hr />
<h1 id="comparing-data-from-different-intervals">Comparing data from different intervals</h1>
<p>Sometimes you want to compare data from different time periods by
overlaying them in one time chart.</p>
<p>For example, imagine you want to see November's daily online store
purchases compared to December's in order to see how they're affected by
the Christmas holiday. You can do this with the
<a href="../timechart/#timechart__duration">-duration</a>
and
<a href="../timechart/#timechart__sink_overlaytime">-overlayTime</a>
parameters.</p>
<p>You can see this feature illustrated in the examples below.</p>
<p><em>Example: Compare yesterday's CPU usage with usage today so far</em></p>
<pre><code>read stochastic -source 'cdn' -source_type 'metric' -last :2 days: -daily .5 name = 'cpu'
| view timechart
    -duration :1 day:
    -overlayTime true
</code></pre>

<p><img alt="" src="../../images/screenshots/view_timechart_overlay_time_1.png" /></p>
<p><em>Example: Compare CPU usage from today with the same day last week</em></p>
<pre><code>(
read stochastic -source 'cdn' -from :7 days ago: -to :6 days ago: -daily .5  -source_type 'metrics' name = 'cpu';
read stochastic -source 'cdn' -from :1 days ago: -to :now: -daily .5  -source_type 'metrics' name = 'cpu'
)
| view timechart
    -duration :1 day:
    -overlayTime true
</code></pre>

<p><img alt="" src="../../images/screenshots/view_timechart_overlay_time_2.png" /></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../timechart_interactive/" class="btn btn-neutral float-right" title="____ Interactive Timecharts"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../timechart/" class="btn btn-neutral" title="timechart"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/juttle/juttle-viz" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../timechart/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../timechart_interactive/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
